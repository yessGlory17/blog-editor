<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Editor</title>
    <link rel="stylesheet" href="./css/reset.css">
    <link rel="stylesheet" href="./css/style.css">
    <script src="./jquery/jquery-3.5.1.min.js"></script>
    <script src="https://kit.fontawesome.com/1389171202.js" crossorigin="anonymous"></script>
</head>
<body>
    <div class="editor">
       <div class="first-container">
        <div class="text-header-container">
            <div class="editor-section-container">
                <div class="editor-buttons">
                    <button class="plus-button">
                        <i class="fas fa-plus"></i>   
                    </button>
                    <button class="image-button">
                        <i class="fas fa-image"></i>
                    </button>
                    <button class="link-button">
                        <i class="fas fa-link"></i>
                    </button>
                </div>
                <p class="editor-section-text" >
                    Title
                </p>
            </div>
           <div class="vertical-line">
                
            </div> 
                <div class="text-header-flex-container">
                    <div class="select-text-box">
                        <button class="select-text-box-bold-button">
                            <i class="fas fa-bold"></i>
                        </button>
                        <button class="select-text-box-italic-button">
                            <i class="fas fa-italic"></i>
                        </button>
                        <button class="select-text-box-link-button">
                            <i class="fas fa-link"></i>
                        </button>
                    </div>
                    <div class="header-input-flex-container-content">
                        <div contenteditable="true" class="header-input" placeholder="Buraya Başlığı Giriniz"></div>
                        
                    </div>
                </div>
        </div>
       </div>

        <!--Asıl İçerik Bölümü-->
        <div class="second-container">
            <div class="text-main-container">
                <div class="editor-main-section-container">
                    <div class="editor-buttons">
                        <button class="plus-button">
                            <i class="fas fa-plus"></i>   
                        </button>
                        <button class="image-button">
                            <i class="fas fa-image"></i>
                        </button>
                        <button class="link-button">
                            <i class="fas fa-link"></i>
                        </button>
                    </div>
                    <p class="editor-section-text">
                        İçerik
                    </p>
                </div>
                <div class="vertical-line">
                    <div class="text-header-flex-container">
                        <div class="select-text-box">
                            <button class="select-text-box-bold-button">
                                <i class="fas fa-bold"></i>
                            </button>
                            <button class="select-text-box-italic-button">
                                <i class="fas fa-italic"></i>
                            </button>
                            <button class="select-text-box-link-button">
                                <i class="fas fa-link"></i>
                            </button>
                        </div>
                        <div class="main-input-flex-container-content">
                            <div class="main-input" contenteditable="true" placeholder="Buraya İçeriği Giriniz"></div>
                        </div>
                    </div>
                </div>
            </div>
            
        </div>

    </div>
    <script>
        
         $(document).ready(function(){

            
           //Düzenleme butonlarına tıklarken + butonu tetikleniyor!
            
            $(".header-input").click(function(){
               $(".header-input").attr("contenteditable","true") 
            });
             //Önce Title Gizle!
             //Eğer Başlık inputuna basıldıysa butonu gizle

             $(".header-input").on("focus",function(){
                //Başlık girişine basıldığında seçenek butonunu kapatır ve o bölgenin ismini göster

                // $(".editor-buttons").css("display","none");
                // $(".editor-section-text").css("display","flex")
                $(".editor-buttons").fadeOut(10);
                $(".editor-section-text").fadeIn(500);

                $(".vertical-line").height($(".header-input").height());

             })

             $(".header-input").on("focusout",function(){
               
               //Başlık girişi inputundan çıktığında bölge ismini kapatır ve seçenek butonunu açar!
                $(".editor-section-text").css("display","none");
                $(".editor-buttons").css("display","flex");

             })


             //Artı butonuna basıldığında diğer içerik ekleme butonlarını gösterir
             var editorButtonsShow = false; //Editor butonunun görünürlüğünü kontrol eder.
             $(".plus-button").click(function(){
                 //alert();
                if(!editorButtonsShow){
                    // $(".image-button").css("display","block");
                    // $(".link-button").css("display","block");
                    $(".image-button").fadeIn(500);
                    $(".link-button").fadeIn(500);

                    editorButtonsShow = !editorButtonsShow;

                }else{

                    // $(".image-button").css("display","none")
                    // $(".link-button").css("display","none")

                    $(".image-button").fadeOut(500);
                    $(".link-button").fadeOut(500);

                    editorButtonsShow = !editorButtonsShow;
                }
             })


             //Yazı Seçme ve Düzenleme
             var linkText = '';//Linke yazıyı aktarma
             $(".header-input").on("mouseup",function(event){
                var secilenYazi = YaziyiSec();
                linkText = YaziyiSec();

                var mPos = {
                    x  : event.pageX,
                    y : event.pageY
                };

                if(secilenYazi != ''){
                    $(".select-text-box").fadeIn(500)
                    $(".select-text-box").offset({
                        top: event.pageY - 100,
                        left : event.pageX - 100
                    });
                    
                    //Yazıyı Düzenlenmek İçin Kalınlaştırma Butonu
                    $(".select-text-box-bold-button").dblclick(function(){
                        
                        //Yazıyı Kalınlaştıracak Fonksiyonu çağırıyoruz.
                        format('bold');
                    })

                    //Yazıyı Düzenlemek İçin Yanaeğme Butonu
                    $(".select-text-box-italic-button").dblclick(function(){

                        //Yazıyı Yanaeğik Yapacak Fonksiyonu Çağırıyoruz.
                        format('italic');
                    })

                    $(".select-text-box-link-button").click(function(){
                        //alert();
                        setUrl();
                    });

                    
                }else{
                    $(".select-text-box").fadeOut(1000)
                }
             })


             //Yazı Seçme Fonksiyonu
             function YaziyiSec(){
                 
                if (window.getSelection) {
                    return window.getSelection();
                } else if (document.selection) {
                    return document.selection.createRange();
                }
                return '';

             }


             //Yazıyı Düzenleme Fonksiyonu
             function format(command,value){
                 //alert();
                 document.execCommand(command,false,value);
             }


             function setUrl(){
                //alert("Set Url Çalıştı")
                if(linkText != ''){
                    var url = linkText;
                    var sText = document.getSelection();
                    document.execCommand('insertHTML', false, '<a href="' + url + '" target="_blank">' + sText + '</a>');
                    document.getElementById(linkText).value = '';
                }
             }
         })
    </script>
</body>
</html>